# Трекер полезных привычек. Django, Celery, Telegram, DRF, Docker.

## Функционал.
 
Программа для выработки привычек. Пользователь создает для себя список периодических 
задач, которые ему необходимо выполнять по расписанию. В чат Telegram-бота присылается
напоминание о том, что ему необходимо выполнить очередное задание, а по выполнении - 
информация о поощрении.

Есть возможность создать два вида привычек:
- Полезная - привычка, выполняемая по расписанию (но не реже 1 раза в 7 дней), по выполнении которой,
пользователь получает поощрение, либо может выполнить еще одну - приятную привычку.
- Приятная привычка выполняется так же, как и полезная, но не имеет поощрений или связанных привычек

По наступлении времени выполнения в чат приходит сообщение о необходимости выполнить задание,
его время и место. По прошествии заданного времени выполнения (не более 120 секунд) приходит 
информация о поощрении если это полезная привычка.

#### При регистрации пользователю необходимо указать свой email, пароль и telegram id, а так же запустить в своем Telegram SkyHabitReminderBot

Возможности пользователя:
- Регистрация
- Авторизация
- Создание привычки
- Изменение своей привычки
- Удаление своей привычки
- Просмотр списка своих созданных привычек с пагинацией
- Просмотр списка публичных привычек, своих и других пользователей с пагинацией

## Работа с Docker

Для создания контейнера Docker необходимо воспользоваться командами
- Сборка Docker-образа
    ```
    > docker build .
    ```
- Сборка контейнера
    ```
    > docker-compose build
    ```
- Запуск контейнера
    ```
    > docker-compose up
    ```

### Требования к установке.
Программа работает с СУБД PostgreSQL.

- В PostgreSQL должна быть создана DB - skychimp
- Необходимо заполнить таблицы БД значениями

Для заполнения БД тестовыми данными необходимо воспользоваться фикстурой all.json
```
> python manage.py loaddata all.json
```
которая содержит в себе несколько тестовых заданий, настроенную задачу celery-beat с периодичностю
выполнения 1 раз в 10 секунд, учетной записи администратора - admin@adminov.ru и нескольких пользователей,
для всех единый пароль - 123456

Для ручного заполнения можно воспользоваться командой 
```
> python manage.py ucreate 
```
для создания администратора, а все данные и настройку celery-beat произвести самостоятельно.

## Запуск сервиса

- Необходимо запустить сервер Redis
- Запустить проект
```
> python manage.py runserver
```
- Запустить celery-beat
```
> celery -A config beat -l info -S django
```
- Запустить celery
```
> celery -A config worker -l info -P eventlet 
```
## Требования к окружению

#### В программе используется менеджер зависимостей venv.
Используются следующие зависимости:

- celery==5.3.4
- coverage==7.3.2
- Django==4.2.6
- django-celery-beat==2.5.0
- djangorestframework==3.14.0
- djangorestframework-simplejwt==5.3.0
- drf-yasg==1.21.7
- eventlet==0.33.3
- ipython==8.16.1
- Pillow==10.1.0
- psycopg2-binary==2.9.9
- python-dotenv==1.0.0
- pytils==0.4.1
- redis==5.0.1
- requests==2.31.0
